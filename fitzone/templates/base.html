<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title_name %}FITZONE{% endblock %}</title>
    
    <!-- CSS -->
    {% load static %}
        <link rel="stylesheet" href="{% static 'css/style.css' %}">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    {% block extra_css %}{% endblock %}
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
</head>
<body class="{% if user.is_authenticated and user.userprofile.theme %}dark-theme{% endif %}">    <!-- Particles Background -->
    <div class="particles-container" id="particles"></div>

    <!-- Header -->
    {% include '_inc/_header.html' %}

    <!-- Main Content -->
    <main class="main-content">
        {% block content %}
        <!-- Content will be injected here -->
        {% endblock %}
    </main>

    <!-- Footer -->
    {% include '_inc/_footer.html' %}

    <!-- Основной JavaScript -->
    <script>
        // Применение темы при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== BASE TEMPLATE LOADED ===');
            console.log('Current theme class:', document.body.className);
            console.log('User authenticated:', {% if user.is_authenticated %}true{% else %}false{% endif %});
            console.log('User theme:', {% if user.is_authenticated and user.userprofiles.theme %}true{% else %}false{% endif %});
            
            // Создание частиц
            const particlesContainer = document.getElementById('particles');
            if (particlesContainer) {
                const particleCount = 15;
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    
                    const size = Math.random() * 100 + 50;
                    const left = Math.random() * 100;
                    const top = Math.random() * 100;
                    const delay = Math.random() * 20;
                    
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    particle.style.left = `${left}%`;
                    particle.style.top = `${top}%`;
                    particle.style.animationDelay = `${delay}s`;
                    
                    particlesContainer.appendChild(particle);
                }
            }

            // Mobile menu toggle
            const hamburger = document.getElementById('hamburger');
            const navLinks = document.getElementById('navLinks');
            
            if (hamburger && navLinks) {
                hamburger.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                    hamburger.classList.toggle('active');
                });
            }

            // Закрытие мобильного меню при клике на ссылку
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.addEventListener('click', () => {
                    if (navLinks && hamburger) {
                        navLinks.classList.remove('active');
                        hamburger.classList.remove('active');
                    }
                });
            });
        });
    </script>

    {% block skripts %}
<!-- Page-specific scripts will be injected here -->
{% endblock %}

<!-- Глобальные сочетания клавиш -->
<script>
document.addEventListener('keydown', function(e) {
    // Ctrl + X для выхода
    if (e.ctrlKey && e.key === 'x' ) {
        e.preventDefault();
        console.log('Ctrl+X pressed - logging out');
        
        // Проверяем, авторизован ли пользователь
        const isAuthenticated = {% if user.is_authenticated %}true{% else %}false{% endif %};
        
        if (isAuthenticated) {
            // Используем Django template tag для получения правильного URL
            window.location.href = "{% url 'logout' %}";
        } else {
            console.log('User not authenticated');
        }
    }
    if (e.ctrlKey && e.key === 'ч' ) {
        e.preventDefault();
        console.log('Ctrl+X pressed - logging out');
        
        // Проверяем, авторизован ли пользователь
        const isAuthenticated = {% if user.is_authenticated %}true{% else %}false{% endif %};
        
        if (isAuthenticated) {
            // Используем Django template tag для получения правильного URL
            window.location.href = "{% url 'logout' %}";
        } else {
            console.log('User not authenticated');
        }
    }
});
</script>
</body>
</html>